Argos Client Library
====================

Purpose
-------

The purpose of this library is to assist in parsing the logs generated by Argos.
The utility `carlog', which is distributed along with the library provides a
demonstration on using it, as well as constitutes a tool to quickly view a 
summary of Argos logs.


Example of using library
------------------------

First you need to create a new instance of the library

cargos_lib_t *calib = cargos_lib_create();

You can use this instance to parse a csi log, and its associated net tracker
log.

cargos_lib_csi_open(calib, "argos.csi.12345689");

cargos_lib_nt_open(calib, "argos.netlog");

These 2 functions parse the files, and if no errors are encountered all desired
data can be accessed.

Register values: cargos_lib_csi_regv(calib, CARGOS_LIB_EAX);
Register memory origins: cargos_lib_csi_rego(calib, CARGOS_LIB_EAX);
Register network indeces: cargos_lib_csi_regnidx(calib, CARGOS_LIB_EAX);

Other header information:
unsigned char cargos_lib_csi_version(cargos_lib_t *inst);
cargos_lib_arch_t cargos_lib_csi_arch(cargos_lib_t *inst);
const char * cargos_lib_csi_archstring(cargos_lib_t *inst);
cargos_lib_attack_t cargos_lib_csi_type(cargos_lib_t *inst);
unsigned int cargos_lib_csi_regs(cargos_lib_t *inst);
cargos_lib_ulong_t cargos_lib_csi_eflags(cargos_lib_t *inst);
int cargos_lib_csi_reg_tainted(cargos_lib_t *inst, cargos_lib_regidx_t index);

See manual pages for additional information.


carlog
------

Running carlog with an Argos csi log will produce output similar to the 
following.

Net tracker data: YES

VERSION         ARCH            TYPE            TIMESTAMP
0x01            i386            RET             1160388566

EAX             ECX             EDX             EBX
 0x00000000      0x006ffd1c      0x7665ff90      0x00000000
(0x00000000)    (0x00000000)    (0x00000000)    (0x00000000)
[       747]    [       747]    [       747]    [       747]

ESP             EBP             ESI             EDI
 0x006ff9f8      0x5a634b28      0x00000004      0x006ffa3c
(0x00000000)    (0x040679e4)    (0x00000000)    (0x00000000)
[       747]    [      8545]    [       747]    [       747]

EIP             EFLAGS
0x773242e0      0x00000202
(0x040679e8)
[8553]

What is displayed is the header information of the csi log.
Interesting fields are the timestamp (1160388566), the type of the detected 
attack (RET).

3 or 2 values are printed for each system register. The first being the value of
 the register the moment of the attack. The 2nd is the physical memory address,
where data were last loaded from (the origin of data in RAM).

If Argos was running in net tracker mode (`Net tracker data: YES') a third
value is printed. This value corresponds to the index of the byte read from the
network that ended up in the register.

Additional information can be printed by using `--verbose', where some
information about the memory of the system are printed.

All `carlog' options are shown by running `carlog --help'.

